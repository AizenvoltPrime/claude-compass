# Claude Compass Environment Configuration
# Copy this file to .env and update the values for your environment

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Primary database URL (used by Knex and most database operations)
DATABASE_URL=postgresql://claude_compass:password@localhost:5432/claude_compass

# Individual database connection parameters (for Docker and direct connections)
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=claude_compass
DATABASE_USER=claude_compass
DATABASE_PASSWORD=password

# Database connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_POOL_IDLE_TIMEOUT=30000
DATABASE_POOL_ACQUIRE_TIMEOUT=60000

# Database timezone (used by Docker containers)
TIMEZONE=Europe/Athens

# =============================================================================
# MCP SERVER CONFIGURATION
# =============================================================================

# Default repository name for MCP tools (optional)
# When set, tools will use this repository if repo_ids parameter is not provided
DEFAULT_REPO_NAME=project_card_game

# STDIO MCP Server (for local Claude Desktop use)
MCP_SERVER_PORT=3000
MCP_SERVER_HOST=localhost

# HTTP MCP Server (for remote access via SSH tunnel)
MCP_HTTP_PORT=3456
MCP_HTTP_HOST=localhost

# Authentication token for HTTP MCP Server (required for remote access)
# Generate with: openssl rand -hex 32
# Leave empty for localhost-only access (no authentication)
MCP_AUTH_TOKEN=

# Allow all hosts (disable DNS rebinding protection) - use with caution
# Set to 'true' only if you need to access from non-localhost addresses
MCP_ALLOW_ALL_HOSTS=false

# Enable MCP server debug logging
MCP_DEBUG=false

# SSH Tunnel Configuration (for unified server auto-tunnel)
# Set to 'true' to automatically create reverse SSH tunnel on server startup
ENABLE_SSH_TUNNEL=false

# Remote SSH host (username@hostname or IP)
SSH_REMOTE_HOST=user@example.com

# Optional: Path to SSH private key (if not using default ~/.ssh/id_rsa or ~/.ssh/id_ed25519)
SSH_KEY_PATH=

# SSH keepalive settings
SSH_SERVER_ALIVE_INTERVAL=30
SSH_SERVER_ALIVE_COUNT_MAX=3

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Cache time-to-live in milliseconds (30 seconds for development)
# Set to 0 to disable caching completely
# Default: 300000 (5 minutes)
CACHE_TTL_MS=30000

# Maximum number of cache entries
# Default: 1000
CACHE_MAX_ENTRIES=1000

# Maximum total cache size in megabytes
# Default: 50
CACHE_MAX_SIZE_MB=50

# Enable cache statistics tracking
# Default: true
CACHE_ENABLE_STATS=true

# =============================================================================
# WEBHOOK CONFIGURATION (for unified server)
# =============================================================================

# Webhook secret for authenticating file change notifications from Hetzner
# Generate with: openssl rand -hex 32
WEBHOOK_SECRET=your-webhook-secret-here

# Claude Compass installation path
COMPASS_PATH=/home/username/Documents/claude-compass

# Local project path (where rsync syncs files to from remote server)
LOCAL_PROJECT_PATH=/home/username/Documents/project_name

# Remote server connection details (for file sync)
REMOTE_HOST=username@remote-server-ip
REMOTE_PROJECT_PATH=/var/www/project_name

# Sync strategy: 'incremental' (fast, only changed files) or 'full' (complete sync)
SYNC_STRATEGY=incremental

# Enable/disable automatic analysis after file sync
ENABLE_ANALYSIS=true

# Analysis command flags (passed to npm run analyze)
# Common flags: --verbose, --skip-embeddings, --force-full, --no-test-files
ANALYSIS_FLAGS=--verbose

# Batch delay in milliseconds (wait time before processing batched file changes)
BATCH_DELAY_MS=3000

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level: error, warn, info, http, verbose, debug, silly
LOG_LEVEL=info

# Log file path (relative to project root)
LOG_FILE=logs/claude-compass.log

# Enable console logging (true/false)
LOG_CONSOLE=true

# Log format: simple, json, combined
LOG_FORMAT=simple

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Environment: development, production, test
NODE_ENV=development

# Application port (for future web interface)
APP_PORT=8080

# Application host
APP_HOST=localhost

# =============================================================================
# PARSING CONFIGURATION
# =============================================================================

# Maximum file size to parse (in bytes, default: 1MB)
MAX_FILE_SIZE=1048576

# Maximum number of files to process per repository
MAX_FILES=10000

# File extensions to parse (comma-separated)
PARSE_EXTENSIONS=.js,.jsx,.ts,.tsx,.mjs,.cjs,.vue,.php,.cs

# Include test files in analysis
INCLUDE_TEST_FILES=false

# Include node_modules in analysis (not recommended)
INCLUDE_NODE_MODULES=false
